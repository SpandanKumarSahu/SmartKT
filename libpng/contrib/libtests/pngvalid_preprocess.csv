21,define,_POSIX_SOURCE 1,
22,define,_ISOC99_SOURCE 1 ,/* For floating point */
23,define,_GNU_SOURCE 1 ,/* For the floating point exception extension */
24,define,_BSD_SOURCE 1 ,/* For the floating point exception extension */
26,include,<signal.h>,
27,include,<stdio.h>,
29,if,defined(HAVE_CONFIG_H) && !defined(PNG_NO_CONFIG_H),
30,,#  include <config.h>,
31,endif,,
33,ifdef,HAVE_FEENABLEEXCEPT ,"/* from config.h, if included */"
34,,#  include <fenv.h>,
35,endif,,
37,ifndef,FE_DIVBYZERO,
38,,#  define FE_DIVBYZERO 0,
39,endif,,
40,ifndef,FE_INVALID,
41,,#  define FE_INVALID 0,
42,endif,,
43,ifndef,FE_OVERFLOW,
44,,#  define FE_OVERFLOW 0,
45,endif,,
50,ifdef,PNG_FREESTANDING_TESTS,
51,,#  include <png.h>,
52,else,,
53,,"#  include ""../../png.h""",
54,endif,,
56,ifdef,PNG_ZLIB_HEADER,
57,,#  include PNG_ZLIB_HEADER,
58,else,,
59,,#  include <zlib.h>   ,/* For crc32 */
60,endif,,
65,if,PNG_LIBPNG_VER >= 10601 && defined(HAVE_CONFIG_H),
66,,#  define SKIP 77,
67,else,,
68,,#  define SKIP 0,
69,endif,,
73,if,defined(PNG_WRITE_SUPPORTED) && (defined(PNG_FIXED_POINT_SUPPORTED) || defined(PNG_FLOATING_POINT_SUPPORTED)),
76,if,PNG_LIBPNG_VER < 10500,
81,define,PNG_INTERLACE_ADAM7_PASSES 7,
82,define,PNG_PASS_START_ROW(pass) (((1U&~(pass))<<(3-((pass)>>1)))&7),
83,define,PNG_PASS_START_COL(pass) (((1U& (pass))<<(3-(((pass)+1)>>1)))&7),
84,define,PNG_PASS_ROW_SHIFT(pass) ((pass)>2?(8-(pass))>>1:3),
85,define,PNG_PASS_COL_SHIFT(pass) ((pass)>1?(7-(pass))>>1:3),
86,define,"PNG_PASS_ROWS(height, pass) (((height)+(((1<<PNG_PASS_ROW_SHIFT(pass)) -1)-PNG_PASS_START_ROW(pass)))>>PNG_PASS_ROW_SHIFT(pass))",
88,define,"PNG_PASS_COLS(width, pass) (((width)+(((1<<PNG_PASS_COL_SHIFT(pass)) -1)-PNG_PASS_START_COL(pass)))>>PNG_PASS_COL_SHIFT(pass))",
90,define,"PNG_ROW_FROM_PASS_ROW(yIn, pass) (((yIn)<<PNG_PASS_ROW_SHIFT(pass))+PNG_PASS_START_ROW(pass))",
92,define,"PNG_COL_FROM_PASS_COL(xIn, pass) (((xIn)<<PNG_PASS_COL_SHIFT(pass))+PNG_PASS_START_COL(pass))",
94,define,"PNG_PASS_MASK(pass,off) ( ((0x110145AFU>>(((7-(off))-(pass))<<2)) & 0xFU) | ((0x01145AF0U>>(((7-(off))-(pass))<<2)) & 0xF0U))",
97,define,"PNG_ROW_IN_INTERLACE_PASS(y, pass) ((PNG_PASS_MASK(pass,0) >> ((y)&7)) & 1)",
99,define,"PNG_COL_IN_INTERLACE_PASS(x, pass) ((PNG_PASS_MASK(pass,1) >> ((x)&7)) & 1)",
103,define,PNG_WRITE_16BIT_SUPPORTED,
104,define,PNG_READ_16BIT_SUPPORTED,
107,define,PNG_FP_1 100000,
108,define,PNG_GAMMA_THRESHOLD_FIXED ((png_fixed_point)(PNG_GAMMA_THRESHOLD * PNG_FP_1)),
110,endif,,
112,if,PNG_LIBPNG_VER < 10600,
116,,#  define png_const_structp png_structp,
117,endif,,
119,ifndef,RELEASE_BUILD,
121,,#  define RELEASE_BUILD (PNG_LIBPNG_BUILD_BASE_TYPE >= PNG_LIBPNG_BUILD_RC),
122,endif,,
123,if,RELEASE_BUILD,
124,,#   define debugonly(something),
125,else,,/* !RELEASE_BUILD */
126,,#   define debugonly(something) something,
127,endif,,/* !RELEASE_BUILD */
129,include,<float.h>  ,/* For floating point constants */
130,include,<stdlib.h> ,/* For malloc */
131,include,<string.h> ,"/* For memcpy, memset */"
132,include,<math.h>   ,/* For floor */
135,define,"CHUNK(a,b,c,d) (((a)<<24)+((b)<<16)+((c)<<8)+(d))",
136,define,"CHUNK_IHDR CHUNK(73,72,68,82)",
137,define,"CHUNK_PLTE CHUNK(80,76,84,69)",
138,define,"CHUNK_IDAT CHUNK(73,68,65,84)",
139,define,"CHUNK_IEND CHUNK(73,69,78,68)",
140,define,"CHUNK_cHRM CHUNK(99,72,82,77)",
141,define,"CHUNK_gAMA CHUNK(103,65,77,65)",
142,define,"CHUNK_sBIT CHUNK(115,66,73,84)",
143,define,"CHUNK_sRGB CHUNK(115,82,71,66)",
148,ifndef,UNUSED,
149,,#  if defined(__GNUC__) || defined(_MSC_VER),
150,,#     define UNUSED(param) (void)param;,
151,,#  else,
152,,#     define UNUSED(param),
153,,#  endif,
154,endif,,
157,ifdef,PNG_FREESTANDING_TESTS,
158,,#  include <cexcept.h>,
159,else,,
160,,"#  include ""../visupng/cexcept.h""",
161,endif,,
163,ifdef,__cplusplus,
164,,#  define this not_the_cpp_this,
165,,#  define new not_the_cpp_new,
166,,"#  define voidcast(type, value) static_cast<type>(value)",
167,else,,
168,,"#  define voidcast(type, value) (value)",
169,endif,,/* __cplusplus */
177,define,anon_context(ps) struct exception_context *the_exception_context = &(ps)->exception_context,
179,define,"context(ps,fault) anon_context(ps); png_store *fault",
186,define,ARRAY_SIZE(a) ((unsigned int)((sizeof (a))/(sizeof (a)[0]))),
194,define,"is_gnu(major,minor) (defined __GNUC__) && __GNUC__ == (major) && __GNUC_MINOR__ == (minor)",
196,define,"is_gnu_patch(major,minor,patch) is_gnu(major,minor) && __GNUC_PATCHLEVEL__ == 0",
199,ifdef,__GNUC__,
201,,#  define gnu_volatile(x) make_volatile_for_gnu = &x;,
202,else,,/* !GNUC broken versions */
203,,#  define gnu_volatile(x),
204,endif,,/* !GNUC broken versions */
233,ifdef,PNG_READ_TRANSFORMS_SUPPORTED,
241,endif,,
252,ifdef,PNG_READ_TRANSFORMS_SUPPORTED,
260,endif,,/* PNG_READ_SUPPORTED */
300,if,defined PNG_READ_SUPPORTED || defined PNG_WRITE_tRNS_SUPPORTED || defined PNG_WRITE_FILTER_SUPPORTED,
309,define,"R8(this) randomize(&(this), sizeof (this))",
311,ifdef,PNG_READ_SUPPORTED,
319,endif,,/* READ */
329,if,defined PNG_READ_RGB_TO_GRAY_SUPPORTED || defined PNG_READ_FILLER_SUPPORTED,
338,endif,,/* READ_FILLER || READ_RGB_TO_GRAY */
340,endif,,/* READ || WRITE_tRNS || WRITE_FILTER */
342,if,defined PNG_READ_TRANSFORMS_SUPPORTED || defined PNG_WRITE_FILTER_SUPPORTED,
349,endif,,/* READ_TRANSFORMS || WRITE_FILTER */
351,if,(defined PNG_READ_RGB_TO_GRAY_SUPPORTED) || (defined PNG_READ_FILLER_SUPPORTED),
358,endif,,/* READ_RGB_TO_GRAY || READ_FILLER */
366,define,"FILEID(col, depth, palette, interlace, width, height, do_interlace) ((png_uint_32)((col) + ((depth)<<3) + ((palette)<<8) + ((interlace)<<13) + (((do_interlace)!=0)<<15) + ((width)<<16) + ((height)<<24)))",
370,define,COL_FROM_ID(id) ((png_byte)((id)& 0x7U)),
371,define,DEPTH_FROM_ID(id) ((png_byte)(((id) >> 3) & 0x1fU)),
372,define,PALETTE_FROM_ID(id) (((id) >> 8) & 0x1f),
373,define,INTERLACE_FROM_ID(id) ((png_byte)(((id) >> 13) & 0x3)),
374,define,DO_INTERLACE_FROM_ID(id) ((int)(((id)>>15) & 1)),
375,define,WIDTH_FROM_ID(id) (((id)>>16) & 0xff),
376,define,HEIGHT_FROM_ID(id) (((id)>>24) & 0xff),
431,ifdef,PNG_WRITE_16BIT_SUPPORTED,
432,,#  define WRITE_BDHI 4,
433,,#  ifdef PNG_READ_16BIT_SUPPORTED,
434,,#     define READ_BDHI 4,
435,,#     define DO_16BIT,
436,,#  endif,
437,else,,
438,,#  define WRITE_BDHI 3,
439,endif,,
440,ifndef,DO_16BIT,
441,,#  define READ_BDHI 3,
442,endif,,
447,define,PALETTE_COUNT(bit_depth) ((bit_depth) > 4 ? 1U : 16U),
484,ifdef,DO_16BIT,
486,endif,,
518,ifdef,PNG_READ_TRANSFORMS_SUPPORTED,
568,endif,,/* PNG_READ_TRANSFORMS_SUPPORTED */
617,ifdef,PNG_READ_SUPPORTED,
647,if,PNG_LIBPNG_VER < 10506,
668,else,,
674,endif,,
684,endif,,/* PNG_READ_SUPPORTED */
691,define,STORE_BUFFER_SIZE 500 ,/* arbitrary */
698,define,FILE_NAME_SIZE 64,
812,ifdef,PNG_READ_TRANSFORMS_SUPPORTED,
832,endif,,/* PNG_READ_SUPPORTED */
1077,ifdef,PNG_READ_SUPPORTED,
1090,endif,,/* PNG_READ_SUPPORTED */
1228,ifdef,PNG_READ_SUPPORTED,
1258,endif,,/* PNG_READ_SUPPORTED */
1381,ifdef,PNG_READ_SUPPORTED,
1737,endif,,/* PNG_READ_SUPPORTED */
1764,ifdef,PNG_READ_SUPPORTED,
1781,endif,,/* PNG_READ_SUPPORTED */
1784,ifdef,PNG_USER_MEM_SUPPORTED,
1985,endif,,/* PNG_USER_MEM_SUPPORTED */
2011,,#  ifdef PNG_USER_MEM_SUPPORTED,
2013,,#  endif,
2039,,#     ifdef PNG_USER_MEM_SUPPORTED,
2046,,#     endif,
2052,,#     ifdef PNG_SET_OPTION_SUPPORTED,
2060,,#     endif,
2079,,#  ifdef PNG_READ_SUPPORTED,
2095,,#  endif,
2097,,#  ifdef PNG_USER_MEM_SUPPORTED,
2100,,#  endif,
2113,ifdef,PNG_READ_SUPPORTED,
2170,,#  ifdef PNG_USER_MEM_SUPPORTED,
2177,,#  endif,
2191,,#  ifdef PNG_SET_OPTION_SUPPORTED,
2199,,#  endif,
2208,endif,,/* PNG_READ_SUPPORTED */
2260,ifdef,PNG_READ_SUPPORTED,
2261,if,defined PNG_READ_TRANSFORMS_SUPPORTED && defined PNG_READ_cHRM_SUPPORTED,
2285,endif,,/* READ_TRANSFORMS && READ_cHRM */
2287,ifdef,PNG_READ_RGB_TO_GRAY_SUPPORTED,
2307,endif,,
2309,ifdef,PNG_READ_TRANSFORMS_SUPPORTED,
2349,endif,,/* READ_TRANSFORMS */
2350,endif,,/* PNG_READ_SUPPORTED */
2538,,#  ifdef PNG_WRITE_tRNS_SUPPORTED,
2540,,#  else,
2542,,#  endif,
2566,ifdef,PNG_READ_TRANSFORMS_SUPPORTED,
2573,define,DIGITIZE PNG_LIBPNG_VER < 10700,
2583,ifdef,PNG_READ_RGB_TO_GRAY_SUPPORTED,
2584,if,DIGITIZE,
2608,endif,,
2609,endif,,/* RGB_TO_GRAY */
2611,ifdef,PNG_READ_GAMMA_SUPPORTED,
2739,endif,,/* PNG_READ_GAMMA_SUPPORTED */
2792,ifdef,PNG_READ_RGB_TO_GRAY_SUPPORTED,
2804,endif,,
2806,ifdef,PNG_READ_TRANSFORMS_SUPPORTED,
2819,endif,,
3421,ifdef,PNG_READ_GAMMA_SUPPORTED,
3488,endif,,/* PNG_READ_GAMMA_SUPPORTED */
3489,endif,,/* PNG_READ_TRANSFORMS_SUPPORTED */
3682,ifdef,PNG_WRITE_tRNS_SUPPORTED,
3685,endif,,
3689,ifdef,PNG_WRITE_tRNS_SUPPORTED,
3732,endif,,
3772,define,TRANSFORM_WIDTH  128U,
3773,define,TRANSFORM_ROWMAX (TRANSFORM_WIDTH*8U),
3774,define,SIZE_ROWMAX (16*8U) ,"/* 16 pixels, max 8 bytes each - 128 bytes */"
3775,define,STANDARD_ROWMAX TRANSFORM_ROWMAX ,/* The larger of the two */
3776,define,SIZE_HEIGHTMAX 16 ,/* Maximum range of size images */
3788,define,"transform_width(pp, colour_type, bit_depth) TRANSFORM_WIDTH",
3813,,#        define TRANSFORM_HEIGHTMAX 2048,
3820,ifdef,PNG_READ_SUPPORTED,
3856,endif,,/* PNG_READ_SUPPORTED */
3974,define,DEPTH(bd) ((png_byte)(1U << (bd))),
3980,ifdef,PNG_WRITE_INTERLACING_SUPPORTED,
3981,,#  define INTERLACE_LAST PNG_INTERLACE_LAST,
3982,,#  define check_interlace_type(type) ((void)(type)),
3983,,"#  define set_write_interlace_handling(pp,type) png_set_interlace_handling(pp)",
3984,,#  define do_own_interlace 0,
3985,elif,PNG_LIBPNG_VER < 10700,
3986,,"#  define set_write_interlace_handling(pp,type) (1)",
4003,,#  define INTERLACE_LAST (PNG_INTERLACE_NONE+1),
4004,,#  define do_own_interlace 0,
4005,else,,/* libpng 1.7+ */
4006,,"#  define set_write_interlace_handling(pp,type) npasses_from_interlace_type(pp,type)",
4008,,#  define check_interlace_type(type) ((void)(type)),
4009,,#  define INTERLACE_LAST PNG_INTERLACE_LAST,
4010,,#  define do_own_interlace 1,
4011,endif,,/* WRITE_INTERLACING tests */
4013,if,PNG_LIBPNG_VER >= 10700 || defined PNG_WRITE_INTERLACING_SUPPORTED,
4014,,#   define CAN_WRITE_INTERLACE 1,
4015,else,,
4016,,#   define CAN_WRITE_INTERLACE 0,
4017,endif,,
4022,ifdef,PNG_READ_INTERLACING_SUPPORTED,
4023,,#  define do_read_interlace 0,
4024,else,,/* no libpng read interlace support */
4025,,#  define do_read_interlace 1,
4026,endif,,
4053,ifdef,PNG_READ_SUPPORTED,
4074,endif,,/* PNG_READ_SUPPORTED */
4082,ifdef,PNG_WRITE_FILTER_SUPPORTED,
4100,else,,/* !WRITE_FILTER */
4101,,"#  define choose_random_filter(pp, start) ((void)0)",
4102,endif,,/* !WRITE_FILTER */
4132,ifdef,PNG_TEXT_SUPPORTED,
4133,,#  if defined(PNG_READ_zTXt_SUPPORTED) && defined(PNG_WRITE_zTXt_SUPPORTED),
4134,,#     define TEXT_COMPRESSION PNG_TEXT_COMPRESSION_zTXt,
4135,,#  else,
4136,,#     define TEXT_COMPRESSION PNG_TEXT_COMPRESSION_NONE,
4137,,#  endif,
4159,endif,,
4164,,#     ifdef PNG_WRITE_tRNS_SUPPORTED,
4167,,#     endif,
4200,,#              if do_own_interlace,
4220,,#              endif ,/* do_own_interlace */
4228,ifdef,PNG_TEXT_SUPPORTED,
4247,endif,,
4357,ifdef,PNG_TEXT_SUPPORTED,
4379,endif,,
4454,,#           ifdef PNG_WRITE_FILTER_SUPPORTED,
4474,,#           endif,
4481,ifdef,PNG_TEXT_SUPPORTED,
4500,endif,,
4542,,#        ifdef PNG_WRITE_INTERLACING_SUPPORTED,
4545,,#        endif,
4546,,#        if CAN_WRITE_INTERLACE,
4552,,#        endif,
4573,ifdef,PNG_READ_SUPPORTED,
4585,endif,,/* PNG_READ_SUPPORTED */
4595,ifdef,PNG_WARNINGS_SUPPORTED,
4669,,#     define exception__prev exception_prev_1,
4670,,#     define exception__env exception_env_1,
4697,undef,exception__prev,
4698,undef,exception__env,
4735,,#                 if do_own_interlace,
4757,,#                 endif ,/* do_own_interlace */
4807,endif,,/* PNG_WARNINGS_SUPPORTED */
4812,ifdef,PNG_WARNINGS_SUPPORTED ,/* else there are no cases that work! */
4830,else,,
4832,endif,,
4841,ifdef,PNG_TIME_RFC1123_SUPPORTED,
4851,,#     if PNG_LIBPNG_VER >= 10600,
4853,,#     endif,
4871,,#     if PNG_LIBPNG_VER < 10600,
4873,,#     else,
4879,,#     endif,
4905,else,,
4907,endif,,
4910,ifdef,PNG_READ_SUPPORTED,
5027,,#     ifdef __GNUC__,
5033,,#     else,
5035,,#     endif,
5320,,#     ifdef PNG_READ_INTERLACING_SUPPORTED,
5323,,#     else ,/* !READ_INTERLACING */
5329,,#     endif ,/* !READ_INTERLACING */
5429,ifdef,PNG_USER_TRANSFORM_INFO_SUPPORTED,
5436,endif,,/* USER_TRANSFORM_INFO */
5448,ifdef,PNG_READ_INTERLACING_SUPPORTED,
5450,endif,,/* READ_INTERLACING */
5458,ifdef,PNG_READ_INTERLACING_SUPPORTED,
5461,endif,,/* PNG_READ_INTERLACING_SUPPORTED */
5534,ifdef,PNG_TEXT_SUPPORTED,
5644,else,,
5645,,"#  define standard_text_validate(dp,pp,pi,check_end) ((void)0)",
5646,endif,,
5911,,#     if CAN_WRITE_INTERLACE,
5919,,#     endif,
5932,,#     ifdef PNG_READ_INTERLACING_SUPPORTED,
5938,,#     if CAN_WRITE_INTERLACE,
5945,,#     endif,
5946,,#     endif ,/* READ_INTERLACING */
5948,,#     ifdef PNG_WRITE_INTERLACING_SUPPORTED,
5956,,#     endif,
5958,,#     ifdef PNG_READ_INTERLACING_SUPPORTED,
5959,,#     ifdef PNG_WRITE_INTERLACING_SUPPORTED,
5967,,#     endif,
5968,,#     endif ,/* READ_INTERLACING */
5990,if,0,
5993,endif,,
6004,ifdef,PNG_READ_TRANSFORMS_SUPPORTED,
6180,if,defined PNG_READ_EXPAND_SUPPORTED || defined PNG_READ_GRAY_TO_RGB_SUPPORTED || defined PNG_READ_EXPAND_SUPPORTED || defined PNG_READ_EXPAND_16_SUPPORTED || defined PNG_READ_BACKGROUND_SUPPORTED,
6228,,#        if PNG_LIBPNG_VER < 10700,
6231,,#        endif,
6238,,#           if PNG_LIBPNG_VER >= 10700,
6241,,#           endif,
6288,endif,,/* transforms that need image_pixel_add_alpha */
6963,,#     if 0,
6973,,#     endif,
7014,define,ITSTRUCT(name) image_transform_##name,
7015,define,ITDATA(name) image_transform_data_##name,
7016,define,image_transform_ini image_transform_default_ini,
7017,define,"IT(name) static image_transform ITSTRUCT(name) = { #name, 1, &PT, /*list*/ 0, /*global_use*/ 0, /*local_use*/ 0, /*next*/ image_transform_ini, image_transform_png_set_##name##_set, image_transform_png_set_##name##_mod, image_transform_png_set_##name##_add }",/*enable*/
7031,define,PT ITSTRUCT(end) ,/* stores the previous transform */
7044,ifdef,PNG_READ_BACKGROUND_SUPPORTED,
7057,endif,,
7059,ifdef,PNG_READ_EXPAND_SUPPORTED,
7093,undef,PT,
7094,define,PT ITSTRUCT(palette_to_rgb),
7095,endif,,/* PNG_READ_EXPAND_SUPPORTED */
7097,ifdef,PNG_READ_EXPAND_SUPPORTED,
7119,if,PNG_LIBPNG_VER < 10700,
7123,endif,,
7129,,#     if PNG_LIBPNG_VER >= 10700,
7132,,#     endif,
7135,if,PNG_LIBPNG_VER < 10700,
7144,endif,,
7164,,#  if PNG_LIBPNG_VER >= 10700,
7166,,#  endif,
7171,undef,PT,
7172,define,PT ITSTRUCT(tRNS_to_alpha),
7173,endif,,/* PNG_READ_EXPAND_SUPPORTED */
7175,ifdef,PNG_READ_GRAY_TO_RGB_SUPPORTED,
7231,undef,PT,
7232,define,PT ITSTRUCT(gray_to_rgb),
7233,endif,,/* PNG_READ_GRAY_TO_RGB_SUPPORTED */
7235,ifdef,PNG_READ_EXPAND_SUPPORTED,
7282,undef,PT,
7283,define,PT ITSTRUCT(expand),
7284,endif,,/* PNG_READ_EXPAND_SUPPORTED */
7286,ifdef,PNG_READ_EXPAND_SUPPORTED,
7305,if,PNG_LIBPNG_VER < 10700,
7307,else,,
7314,endif,,/* 1.7 or later */
7321,if,PNG_LIBPNG_VER < 10700,
7324,else,,
7334,endif,,/* 1.7 or later */
7338,undef,PT,
7339,define,PT ITSTRUCT(expand_gray_1_2_4_to_8),
7340,endif,,/* PNG_READ_EXPAND_SUPPORTED */
7342,ifdef,PNG_READ_EXPAND_16_SUPPORTED,
7351,,#  if PNG_LIBPNG_VER < 10700,
7354,,#  endif,
7393,undef,PT,
7394,define,PT ITSTRUCT(expand_16),
7395,endif,,/* PNG_READ_EXPAND_16_SUPPORTED */
7397,ifdef,PNG_READ_SCALE_16_TO_8_SUPPORTED  ,/* API added in 1.5.4 */
7404,,#  if PNG_LIBPNG_VER < 10700,
7407,,#  endif,
7441,undef,PT,
7442,define,PT ITSTRUCT(scale_16),
7443,endif,,/* PNG_READ_SCALE_16_TO_8_SUPPORTED (1.5.4 on) */
7445,ifdef,PNG_READ_16_TO_8_SUPPORTED ,/* the default before 1.5.4 */
7452,,#  if PNG_LIBPNG_VER < 10700,
7455,,#  endif,
7476,,#     ifdef PNG_READ_ACCURATE_SCALE_SUPPORTED,
7477,,#        if PNG_LIBPNG_VER >= 10504,
7478,,#           error PNG_READ_ACCURATE_SCALE should not be set,
7479,,#        endif,
7493,,#     endif,
7512,undef,PT,
7513,define,PT ITSTRUCT(strip_16),
7514,endif,,/* PNG_READ_16_TO_8_SUPPORTED */
7516,ifdef,PNG_READ_STRIP_ALPHA_SUPPORTED,
7555,undef,PT,
7556,define,PT ITSTRUCT(strip_alpha),
7557,endif,,/* PNG_READ_STRIP_ALPHA_SUPPORTED */
7559,ifdef,PNG_READ_RGB_TO_GRAY_SUPPORTED,
7577,define,data ITDATA(rgb_to_gray),
7583,,#  ifdef PNG_FLOATING_POINT_SUPPORTED,
7586,,#  else,
7589,,#  endif,
7600,undef,image_transform_ini,
7601,define,image_transform_ini image_transform_png_set_rgb_to_gray_ini,
7639,,#     if PNG_LIBPNG_VER < 10700,
7643,,#     else,
7647,,#     endif,
7688,,#     ifdef PNG_FLOATING_POINT_SUPPORTED,
7691,,#     else,
7694,,#     endif,
7722,,#        if PNG_LIBPNG_VER < 10700,
7725,,#        endif,
7745,if,DIGITIZE,
7747,else,,
7749,endif,,
7769,,#  ifdef PNG_FLOATING_POINT_SUPPORTED,
7771,,#  else,
7774,,#  endif,
7776,,#  ifdef PNG_READ_cHRM_SUPPORTED,
7784,,#        ifdef PNG_FLOATING_POINT_SUPPORTED,
7785,,#           define API_function png_get_cHRM_XYZ,
7786,,"#           define API_form ""FP""",
7787,,#           define API_type double,
7788,,#           define API_cvt(x) (x),
7789,,#        else,
7790,,#           define API_function png_get_cHRM_XYZ_fixed,
7791,,"#           define API_form ""fixed""",
7792,,#           define API_type png_fixed_point,
7793,,#           define API_cvt(x) ((double)(x)/PNG_FP_1),
7794,,#        endif,
7841,,"#           define CHECK(col,x) { double err = fabs(o.col.x - e.col.x); if (err > maxe) { maxe = err; el = #col ""("" #x "")""; } }",
7885,,#  endif ,/* READ_cHRM */
7899,,#     if PNG_LIBPNG_VER < 10700,
7902,,#     endif,
7905,,#  if DIGITIZE,
7935,,"#        define DD(v,d,r) (digitize(v*(1-DBL_EPSILON), d, r) * (1-DBL_EPSILON))",
7936,,"#        define DU(v,d,r) (digitize(v*(1+DBL_EPSILON), d, r) * (1+DBL_EPSILON))",
8042,,#        undef DD,
8043,,#        undef DU,
8060,if,!RELEASE_BUILD,
8074,endif,,/* !RELEASE_BUILD */
8077,,#  else  ,/* !DIGITIZE */
8086,,#        if PNG_LIBPNG_VER < 10700,
8099,,#        endif ,/* before 1.7 */
8186,if,!RELEASE_BUILD,
8202,endif,,/* !RELEASE_BUILD */
8205,,#  endif ,/* !DIGITIZE */
8239,undef,data,
8241,undef,PT,
8242,define,PT ITSTRUCT(rgb_to_gray),
8243,undef,image_transform_ini,
8244,define,image_transform_ini image_transform_default_ini,
8245,endif,,/* PNG_READ_RGB_TO_GRAY_SUPPORTED */
8247,ifdef,PNG_READ_BACKGROUND_SUPPORTED,
8256,define,data ITDATA(background),
8313,ifdef,PNG_FLOATING_POINT_SUPPORTED,
8315,else,,
8317,endif,,
8379,define,image_transform_png_set_background_add image_transform_default_add,
8381,undef,data,
8383,undef,PT,
8384,define,PT ITSTRUCT(background),
8385,endif,,/* PNG_READ_BACKGROUND_SUPPORTED */
8402,ifdef,PNG_READ_INVERT_ALPHA_SUPPORTED,
8440,undef,PT,
8441,define,PT ITSTRUCT(invert_alpha),
8443,endif,,/* PNG_READ_INVERT_ALPHA_SUPPORTED */
8446,ifdef,PNG_READ_BGR_SUPPORTED,
8487,undef,PT,
8488,define,PT ITSTRUCT(bgr),
8490,endif,,/* PNG_READ_BGR_SUPPORTED */
8493,ifdef,PNG_READ_SWAP_ALPHA_SUPPORTED,
8534,undef,PT,
8535,define,PT ITSTRUCT(swap_alpha),
8537,endif,,/* PNG_READ_SWAP_ALPHA_SUPPORTED */
8540,ifdef,PNG_READ_SWAP_SUPPORTED,
8577,undef,PT,
8578,define,PT ITSTRUCT(swap),
8580,endif,,/* PNG_READ_SWAP_SUPPORTED */
8582,ifdef,PNG_READ_FILLER_SUPPORTED,
8592,define,data ITDATA(filler),
8658,undef,data,
8660,undef,PT,
8661,define,PT ITSTRUCT(filler),
8665,define,data ITDATA(add_alpha),
8719,undef,data,
8721,undef,PT,
8722,define,PT ITSTRUCT(add_alpha),
8724,endif,,/* PNG_READ_FILLER_SUPPORTED */
8727,ifdef,PNG_READ_PACK_SUPPORTED,
8773,undef,PT,
8774,define,PT ITSTRUCT(packing),
8776,endif,,/* PNG_READ_PACK_SUPPORTED */
8779,ifdef,PNG_READ_PACKSWAP_SUPPORTED,
8818,undef,PT,
8819,define,PT ITSTRUCT(packswap),
8821,endif,,/* PNG_READ_PACKSWAP_SUPPORTED */
8825,ifdef,PNG_READ_INVERT_MONO_SUPPORTED,
8863,undef,PT,
8864,define,PT ITSTRUCT(invert_mono),
8866,endif,,/* PNG_READ_INVERT_MONO_SUPPORTED */
8868,ifdef,PNG_READ_SHIFT_SUPPORTED,
8874,define,data ITDATA(shift),
8944,undef,PT,
8945,define,PT ITSTRUCT(shift),
8947,endif,,/* PNG_READ_SHIFT_SUPPORTED */
8949,ifdef,THIS_IS_THE_PROFORMA,
8977,endif,,
9201,endif,,/* PNG_READ_TRANSFORMS_SUPPORTED */
9204,ifdef,PNG_READ_GAMMA_SUPPORTED,
9231,define,ALPHA_MODE_OFFSET 4,
9276,,#     ifdef PNG_READ_SCALE_16_TO_8_SUPPORTED,
9278,,#     else,
9280,,#        ifdef PNG_READ_16_TO_8_SUPPORTED,
9282,,#        else,
9284,,#        endif,
9285,,#     endif,
9288,,#     ifdef PNG_READ_EXPAND_16_SUPPORTED,
9290,,#     else,
9292,,#     endif,
9296,,#     ifdef PNG_READ_ALPHA_MODE_SUPPORTED,
9306,,#        ifndef PNG_FLOATING_POINT_SUPPORTED,
9308,,#        endif,
9310,,#        ifdef PNG_FLOATING_POINT_SUPPORTED,
9312,,#        else,
9314,,#        endif,
9322,,#           ifdef PNG_FLOATING_POINT_SUPPORTED,
9324,,#           else,
9327,,#           endif,
9330,,#     else,
9332,,#     endif,
9338,,#     ifdef PNG_FLOATING_POINT_SUPPORTED,
9340,,#     else,
9346,,#     endif,
9350,,#     ifdef PNG_READ_BACKGROUND_SUPPORTED,
9354,,#        ifndef PNG_FLOATING_POINT_SUPPORTED,
9356,,#        endif,
9358,,#        ifdef PNG_FLOATING_POINT_SUPPORTED,
9361,,#        else,
9364,,#        endif,
9365,,#     else,
9367,,#     endif,
9484,,#     if 0,
9488,,#     endif,
9528,ifdef,PNG_READ_BACKGROUND_SUPPORTED,
9546,endif,,
9548,ifdef,PNG_READ_ALPHA_MODE_SUPPORTED,
9573,endif,,
9613,ifdef,PNG_READ_ALPHA_MODE_SUPPORTED,
9615,endif,,
9617,ifdef,PNG_READ_ALPHA_MODE_SUPPORTED,
9619,endif,,
9691,ifdef,PNG_READ_ALPHA_MODE_SUPPORTED,
9693,endif,,
9703,ifdef,PNG_READ_ALPHA_MODE_SUPPORTED,
9713,endif,,
9865,,#           if PNG_LIBPNG_VER < 10700,
9866,,#              define SBIT_ERROR .5,
9867,,#           else,
9868,,#              define SBIT_ERROR 1.,
9869,,#           endif,
9924,,#           ifndef PNG_READ_16_TO_8_ACCURATE_SCALE_SUPPORTED,
9925,,#              if PNG_LIBPNG_VER < 10504,
9965,,#              endif,
9966,,#           endif,
9992,,#           ifdef PNG_READ_BACKGROUND_SUPPORTED,
9997,,#           endif,
9998,,#           ifdef PNG_READ_ALPHA_MODE_SUPPORTED,
10003,,#           endif ,/* ALPHA_MODE_SUPPORTED */
10142,,#              ifdef PNG_WARNINGS_SUPPORTED,
10144,,#              else,
10146,,#              endif,
10708,ifdef,DO_16BIT,
10711,,#  ifndef PNG_MAX_GAMMA_8,
10712,,#     define PNG_MAX_GAMMA_8 11,
10713,,#  endif,
10714,,#  if defined PNG_MAX_GAMMA_8 || PNG_LIBPNG_VER < 10700,
10715,,#     define SBIT_16_TO_8 PNG_MAX_GAMMA_8,
10716,,#  else,
10717,,#     define SBIT_16_TO_8 16,
10718,,#  endif,
10766,endif,,/* 16 to 8 bit conversion */
10768,if,defined(PNG_READ_BACKGROUND_SUPPORTED) || defined(PNG_READ_ALPHA_MODE_SUPPORTED),
10807,ifdef,PNG_READ_ALPHA_MODE_SUPPORTED,
10824,endif,,
10846,,#     if DIGITIZE,
10860,,#     endif,
10940,if,0 ,/* TODO: FIXME */
10943,endif,,
10960,endif,,/* READ_BACKGROUND || READ_ALPHA_MODE */
11014,,#  ifdef PNG_READ_BACKGROUND_SUPPORTED,
11016,,#  endif,
11078,ifdef,DO_16BIT ,/* Should be READ_16BIT_SUPPORTED */
11097,endif,,
11099,ifdef,PNG_READ_BACKGROUND_SUPPORTED,
11124,endif,,
11126,ifdef,PNG_READ_ALPHA_MODE_SUPPORTED,
11152,endif,,
11154,endif,,/* PNG_READ_GAMMA_SUPPORTED */
11155,endif,,/* PNG_READ_SUPPORTED */
11657,ifdef,HAVE_FEENABLEEXCEPT,
11663,endif,,
11701,,#  ifdef PNG_WRITE_tRNS_SUPPORTED,
11703,,#  endif,
11714,,#  if PNG_LIBPNG_VER < 10700,
11716,,#  else,
11718,,#  endif,
11744,,#  if PNG_LIBPNG_VER < 10700,
11746,,#  else,
11748,,#  endif,
11810,ifdef,PNG_READ_TRANSFORMS_SUPPORTED,
11824,endif,,/* PNG_READ_TRANSFORMS_SUPPORTED */
11893,,#     ifdef PNG_WRITE_tRNS_SUPPORTED,
11896,,#     endif,
11915,,#        if CAN_WRITE_INTERLACE,
11917,,#        else ,/* !CAN_WRITE_INTERLACE */
11920,,#        endif ,/* !CAN_WRITE_INTERLACE */
11991,ifdef,PNG_SET_OPTION_SUPPORTED,
11998,ifdef,PNG_ARM_NEON,
12003,endif,,
12004,ifdef,PNG_EXTENSIONS,
12009,endif,,
12010,ifdef,PNG_MAXIMUM_INFLATE_WINDOW,
12015,endif,,
12038,endif,,/* PNG_SET_OPTION_SUPPORTED */
12104,,#        ifdef PNG_READ_SUPPORTED,
12106,,#        endif,
12114,,#        ifdef PNG_READ_SUPPORTED,
12116,,#        endif,
12119,ifdef,PNG_READ_TRANSFORMS_SUPPORTED,
12123,endif,,/* PNG_READ_TRANSFORMS_SUPPORTED */
12125,ifdef,PNG_READ_GAMMA_SUPPORTED,
12128,endif,,
12150,if,defined(PNG_FLOATING_ARITHMETIC_SUPPORTED) || PNG_LIBPNG_VER < 10500,
12152,else,,
12154,endif,,
12222,else,,/* write or low level APIs not supported */
12230,endif,,
