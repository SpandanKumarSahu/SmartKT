17,include,"""pngpriv.h""",
19,ifdef,PNG_READ_SUPPORTED,
32,if,defined(PNG_READ_gAMA_SUPPORTED) || defined(PNG_READ_cHRM_SUPPORTED),
38,define,PNG_FIXED_ERROR (-1),
54,endif,,
56,ifdef,PNG_READ_INT_FUNCTIONS_SUPPORTED,
117,endif,,/* READ_INT_FUNCTIONS */
132,ifdef,PNG_IO_STATE_SUPPORTED,
134,endif,,
161,ifdef,PNG_IO_STATE_SUPPORTED,
163,endif,,
187,ifdef,PNG_IO_STATE_SUPPORTED,
189,endif,,
270,ifdef,PNG_IO_STATE_SUPPORTED,
272,endif,,
287,if,defined(PNG_READ_iCCP_SUPPORTED) || defined(PNG_READ_iTXt_SUPPORTED) || defined(PNG_READ_pCAL_SUPPORTED) || defined(PNG_READ_sCAL_SUPPORTED) || defined(PNG_READ_sPLT_SUPPORTED) || defined(PNG_READ_tEXt_SUPPORTED) || defined(PNG_READ_zTXt_SUPPORTED) || defined(PNG_SEQUENTIAL_READ_SUPPORTED),
334,endif,,/* READ_iCCP|iTXt|pCAL|sCAL|sPLT|tEXt|zTXt|SEQUENTIAL_READ */
354,if,PNG_RELEASE_BUILD,
357,else,,
359,endif,,
377,if,ZLIB_VERNUM >= 0x1240,
380,,# if defined(PNG_SET_OPTION_SUPPORTED) && defined(PNG_MAXIMUM_INFLATE_WINDOW),
392,,# endif,
394,endif,,/* ZLIB_VERNUM >= 0x1240 */
406,if,ZLIB_VERNUM >= 0x1240,
408,else,,
410,endif,,
415,if,ZLIB_VERNUM >= 0x1240,
417,else,,
419,endif,,
425,if,ZLIB_VERNUM >= 0x1290 && defined(PNG_SET_OPTION_SUPPORTED) && defined(PNG_IGNORE_ADLER32),
430,endif,,
441,ifdef,window_bits,
442,,# undef window_bits,
443,endif,,
446,if,ZLIB_VERNUM >= 0x1240,
469,endif,,/* Zlib >= 1.2.4 */
471,ifdef,PNG_READ_COMPRESSED_TEXT_SUPPORTED,
472,if,defined(PNG_READ_zTXt_SUPPORTED) || defined (PNG_READ_iTXt_SUPPORTED),
624,,# ifdef PNG_SET_USER_LIMITS_SUPPORTED,
628,,# elif PNG_USER_CHUNK_MALLOC_MAX > 0,
631,,# endif,
766,endif,,/* READ_zTXt || READ_iTXt */
767,endif,,/* READ_COMPRESSED_TEXT */
769,ifdef,PNG_READ_iCCP_SUPPORTED,
834,endif,,/* READ_iCCP */
874,ifdef,PNG_MNG_FEATURES_SUPPORTED,
876,endif,,
917,ifdef,PNG_POINTER_INDEXING_SUPPORTED,
919,endif,,
953,ifndef,PNG_READ_OPT_PLTE_SUPPORTED,
959,endif,,
990,ifdef,PNG_POINTER_INDEXING_SUPPORTED,
1000,else,,
1011,endif,,
1018,ifndef,PNG_READ_OPT_PLTE_SUPPORTED,
1020,endif,,
1025,ifndef,PNG_READ_OPT_PLTE_SUPPORTED,
1050,endif,,
1071,ifdef,PNG_READ_tRNS_SUPPORTED,
1086,endif,,
1088,ifdef,PNG_READ_hIST_SUPPORTED,
1091,endif,,
1093,ifdef,PNG_READ_bKGD_SUPPORTED,
1096,endif,,
1118,ifdef,PNG_READ_gAMA_SUPPORTED,
1154,endif,,
1156,ifdef,PNG_READ_sBIT_SUPPORTED,
1236,endif,,
1238,ifdef,PNG_READ_cHRM_SUPPORTED,
1308,endif,,
1310,ifdef,PNG_READ_sRGB_SUPPORTED,
1358,endif,,/* READ_sRGB */
1360,ifdef,PNG_READ_iCCP_SUPPORTED,
1536,,# if defined(PNG_sRGB_SUPPORTED) && PNG_sRGB_PROFILE_CHECKS >= 0,
1541,,# endif,
1636,endif,,/* READ_iCCP */
1638,ifdef,PNG_READ_sPLT_SUPPORTED,
1654,ifdef,PNG_USER_LIMITS_SUPPORTED,
1670,endif,,
1682,ifdef,PNG_MAX_MALLOC_64K,
1689,endif,,
1757,ifdef,PNG_POINTER_INDEXING_SUPPORTED,
1780,else,,
1804,endif,,
1813,endif,,/* READ_sPLT */
1815,ifdef,PNG_READ_tRNS_SUPPORTED,
1917,endif,,
1919,ifdef,PNG_READ_bKGD_SUPPORTED,
2035,endif,,
2037,ifdef,PNG_READ_eXIf_SUPPORTED,
2098,endif,,
2100,ifdef,PNG_READ_hIST_SUPPORTED,
2150,endif,,
2152,ifdef,PNG_READ_pHYs_SUPPORTED,
2196,endif,,
2198,ifdef,PNG_READ_oFFs_SUPPORTED,
2242,endif,,
2244,ifdef,PNG_READ_pCAL_SUPPORTED,
2371,endif,,
2373,ifdef,PNG_READ_sCAL_SUPPORTED,
2465,endif,,
2467,ifdef,PNG_READ_tIME_SUPPORTED,
2510,endif,,
2512,ifdef,PNG_READ_tEXt_SUPPORTED,
2525,ifdef,PNG_USER_LIMITS_SUPPORTED,
2541,endif,,
2549,ifdef,PNG_MAX_MALLOC_64K,
2556,endif,,
2591,endif,,
2593,ifdef,PNG_READ_zTXt_SUPPORTED,
2604,ifdef,PNG_USER_LIMITS_SUPPORTED,
2620,endif,,
2708,endif,,
2710,ifdef,PNG_READ_iTXt_SUPPORTED,
2721,ifdef,PNG_USER_LIMITS_SUPPORTED,
2737,endif,,
2858,endif,,
2860,ifdef,PNG_READ_UNKNOWN_CHUNKS_SUPPORTED,
2873,,#  ifdef PNG_SET_USER_LIMITS_SUPPORTED,
2878,,#  elif PNG_USER_CHUNK_MALLOC_MAX > 0,
2881,,#  endif,
2918,endif,,/* READ_UNKNOWN_CHUNKS */
2929,ifdef,PNG_READ_UNKNOWN_CHUNKS_SUPPORTED,
2941,,#  ifndef PNG_HANDLE_AS_UNKNOWN_SUPPORTED,
2942,,#     ifdef PNG_SET_UNKNOWN_CHUNKS_SUPPORTED,
2944,,#     endif,
2945,,#  endif,
2951,,#  ifdef PNG_READ_USER_CHUNKS_SUPPORTED,
2990,,#              ifdef PNG_SET_UNKNOWN_CHUNKS_SUPPORTED,
2999,,#              endif,
3018,,#  endif ,/* READ_USER_CHUNKS */
3020,,#  ifdef PNG_SAVE_UNKNOWN_CHUNKS_SUPPORTED,
3041,,#  else,
3042,,#     ifndef PNG_READ_USER_CHUNKS_SUPPORTED,
3043,,#        error no method to support READ_UNKNOWN_CHUNKS,
3044,,#     endif,
3058,,#  endif,
3060,,#  ifdef PNG_STORE_UNKNOWN_CHUNKS_SUPPORTED,
3068,,#     ifdef PNG_USER_LIMITS_SUPPORTED,
3085,,#  endif ,/* USER_LIMITS */
3092,,#  ifdef PNG_USER_LIMITS_SUPPORTED,
3095,,#  endif,
3097,,#  else ,/* no store support: the chunk must be handled by the user callback */
3099,,#  endif,
3109,else,,/* !PNG_READ_UNKNOWN_CHUNKS_SUPPORTED */
3114,endif,,/* !READ_UNKNOWN_CHUNKS */
3157,,# ifdef PNG_SET_USER_LIMITS_SUPPORTED,
3161,,# elif PNG_USER_CHUNK_MALLOC_MAX > 0,
3164,,# endif,
3240,,#     ifdef PNG_READ_PACKSWAP_SUPPORTED,
3246,,#     endif,
3257,ifdef,PNG_READ_INTERLACING_SUPPORTED,
3309,,#        if PNG_USE_COMPILE_TIME_MASKS,
3310,,"#           define PNG_LSR(x,s) ((x)>>((s) & 0x1f))",
3311,,"#           define PNG_LSL(x,s) ((x)<<((s) & 0x1f))",
3312,,#        else,
3313,,"#           define PNG_LSR(x,s) ((x)>>(s))",
3314,,"#           define PNG_LSL(x,s) ((x)<<(s))",
3315,,#        endif,
3316,,"#        define S_COPY(p,x) (((p)<4 ? PNG_LSR(0x80088822,(3-(p))*8+(7-(x))) : PNG_LSR(0xaa55ff00,(7-(p))*8+(7-(x)))) & 1)",
3318,,"#        define B_COPY(p,x) (((p)<4 ? PNG_LSR(0xff0fff33,(3-(p))*8+(7-(x))) : PNG_LSR(0xff55ff00,(7-(p))*8+(7-(x)))) & 1)",
3327,,"#        define PIXEL_MASK(p,x,d,s) (PNG_LSL(((PNG_LSL(1U,(d)))-1),(((x)*(d))^((s)?8-(d):0))))",
3332,,"#        define S_MASKx(p,x,d,s) (S_COPY(p,x)?PIXEL_MASK(p,x,d,s):0)",
3333,,"#        define B_MASKx(p,x,d,s) (B_COPY(p,x)?PIXEL_MASK(p,x,d,s):0)",
3339,,"#        define MASK_EXPAND(m,d) ((m)*((d)==1?0x01010101:((d)==2?0x00010001:1)))",
3341,,"#        define S_MASK(p,d,s) MASK_EXPAND(S_MASKx(p,0,d,s) + S_MASKx(p,1,d,s) + S_MASKx(p,2,d,s) + S_MASKx(p,3,d,s) + S_MASKx(p,4,d,s) + S_MASKx(p,5,d,s) + S_MASKx(p,6,d,s) + S_MASKx(p,7,d,s), d)",
3345,,"#        define B_MASK(p,d,s) MASK_EXPAND(B_MASKx(p,0,d,s) + B_MASKx(p,1,d,s) + B_MASKx(p,2,d,s) + B_MASKx(p,3,d,s) + B_MASKx(p,4,d,s) + B_MASKx(p,5,d,s) + B_MASKx(p,6,d,s) + B_MASKx(p,7,d,s), d)",
3349,if,PNG_USE_COMPILE_TIME_MASKS,
3355,,"#        define S_MASKS(d,s) { S_MASK(0,d,s), S_MASK(1,d,s), S_MASK(2,d,s), S_MASK(3,d,s), S_MASK(4,d,s), S_MASK(5,d,s) }",
3358,,"#        define B_MASKS(d,s) { B_MASK(1,d,s), B_MASK(3,d,s), B_MASK(5,d,s) }",
3360,,#        define DEPTH_INDEX(d) ((d)==1?0:((d)==2?1:2)),
3384,,"#        define MASK(pass,depth,display,png) ((display)?display_mask[png][DEPTH_INDEX(depth)][pass>>1]: row_mask[png][DEPTH_INDEX(depth)][pass])",
3388,else,,/* !PNG_USE_COMPILE_TIME_MASKS */
3392,,"#        define MASK(pass,depth,display,png) ((display)?B_MASK(pass,depth,png):S_MASK(pass,depth,png))",
3394,endif,,/* !USE_COMPILE_TIME_MASKS */
3404,,#        ifdef PNG_READ_PACKSWAP_SUPPORTED,
3409,,#        endif,
3549,if,PNG_ALIGN_TYPE != PNG_ALIGN_NONE,
3645,endif,,/* ALIGN_TYPE code */
3669,endif,,/* READ_INTERLACING */
3682,ifdef,PNG_READ_INTERLACING_SUPPORTED,
3712,ifdef,PNG_READ_PACKSWAP_SUPPORTED,
3723,endif,,
3773,ifdef,PNG_READ_PACKSWAP_SUPPORTED,
3784,endif,,
3837,ifdef,PNG_READ_PACKSWAP_SUPPORTED,
3848,endif,,
3924,ifndef,PNG_READ_PACKSWAP_SUPPORTED,
3926,endif,,
3928,endif,,/* READ_INTERLACING */
4014,ifdef,PNG_USE_ABS,
4018,else,,
4022,endif,,
4072,ifdef,PNG_USE_ABS,
4076,else,,
4080,endif,,
4117,ifdef,PNG_FILTER_OPTIMIZATIONS,
4127,endif,,
4147,ifdef,PNG_SEQUENTIAL_READ_SUPPORTED,
4388,endif,,/* SEQUENTIAL_READ */
4412,ifdef,PNG_READ_TRANSFORMS_SUPPORTED,
4414,endif,,
4448,ifdef,PNG_READ_PACK_SUPPORTED,
4451,endif,,
4453,ifdef,PNG_READ_EXPAND_SUPPORTED,
4483,endif,,
4485,ifdef,PNG_READ_EXPAND_16_SUPPORTED,
4488,,#  ifdef PNG_READ_EXPAND_SUPPORTED,
4498,,#  endif,
4501,endif,,
4503,ifdef,PNG_READ_FILLER_SUPPORTED,
4525,endif,,
4527,ifdef,PNG_READ_GRAY_TO_RGB_SUPPORTED,
4531,ifdef,PNG_READ_EXPAND_SUPPORTED,
4534,endif,,
4535,ifdef,PNG_READ_FILLER_SUPPORTED,
4537,endif,,
4565,endif,,
4567,if,defined(PNG_READ_USER_TRANSFORM_SUPPORTED) && defined(PNG_USER_TRANSFORM_PTR_SUPPORTED),
4577,endif,,
4595,ifdef,PNG_MAX_MALLOC_64K,
4598,endif,,
4614,ifdef,PNG_ALIGNED_MEMORY_SUPPORTED,
4632,else,,
4636,endif,,
4640,ifdef,PNG_MAX_MALLOC_64K,
4644,endif,,
4681,endif,,/* READ */
